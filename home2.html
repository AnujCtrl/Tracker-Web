<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link rel="icon" href="assets/shield.png" type="image/icon type">
    <!--Bootstrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <!--Google Fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@300;400;500;700;800&display=swap"
        rel="stylesheet">
    <!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/996973c893.js" crossorigin="anonymous"></script>
    <!--Map Box-->
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.css' rel='stylesheet' />

</head>

<body style="background-color: #181820; font-family: 'Work Sans', sans-serif; max-width: 1900px;">

    <nav class="navbar navbar-expand-lg"
        style="background-color: #1D1D27; box-shadow: 0px 8px 8px -6px rgba(0,0,0,.25);">
        <div class="container-fluid">
            <a class="navbar-brand" style="color: #FC76A1; font-weight: 700;">C Square</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <!-- <a class="nav-link active" aria-current="page" href="#">Home</a> -->
                    </li>
                </ul>
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a href="home2.html">
                        <img src="assets/firebase.png" type="button" style="background-color: #039BE5; padding: 3px; 
                            border-radius: 1vw; margin: 0.2vw; margin-right: 1vw; height: 35px; width: 35px;"></a>
                    </li>
                    
                    <li class="nav-item">
                        <img src="assets/profilepic.png" type="button" data-bs-toggle="modal"
                            data-bs-target="#exampleModal" style="margin: 0.2vw; height: 35px; width: 35px;">
                    </li>
                </ul>
                <!-- <form class="d-flex">
              <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
              <button class="btn btn-outline-success" type="submit">Search</button>
            </form> -->
            </div>
        </div>
    </nav>

    <div class="container-fluid" style="background-color: #181820; ">
        <div class="row">
            <div class="col-2" style=" background-color: #1D1D27; text-align: left; border-bottom-right-radius: 1vw;">
                <table class="container" style="margin-top: 3vw; ">
                    <tbody style="color: white;">
                        <tr class="fade-item">
                            <td class="fade-item"
                                style="padding: 1vw; border-radius: 0.5vw; background-color: #272732;"><i
                                    style="background-color: #FC76A1; padding: 8px; font-size: 20px; border-radius: 1vw;"
                                    class="fas fa-map-marked-alt"></i><span style="font-size: 15px; font-weight: 500;">
                                    &nbsp<a href="home.html"> Cases</a></span> </td>
                        </tr>
                        <tr style="height: 1vw;">
                        <tr>
                            <td class="fade-item" style="padding: 1vw; border-radius: 0.5vw;"><i
                                    style="background-color: #70C4BF; padding: 8px; font-size: 20px; border-radius: 1vw;"
                                    class="fas fa-chart-line"></i><span style="font-size: 15px; font-weight: 500;">
                                    &nbsp<a href="analytics.html"> Analytics</a></span> </td>
                        </tr>
                        <tr style="height: 1vw;"></tr>
                        <tr>
                            <td class="fade-item" style="padding: 1vw; border-radius: 0.5vw;"><i
                                    style="background-color: #AE68E6; padding: 8px; font-size: 20px; border-radius: 1vw;"
                                    class="fas fa-book"></i><span style="font-size: 15px; font-weight: 500;">
                                    &nbsp<a href="documentation.html"> Documentation</a></span> </td>
                        </tr>
                        <tr style="height: 1vw;"></tr>
                        <tr>
                            <td class="fade-item" style="padding: 1vw; border-radius: 0.5vw;"><i
                                    style="background-color: #E39264; padding: 8px; font-size: 20px; border-radius: 1vw;"
                                    class="fas fa-user-friends"></i><span style="font-size: 15px; font-weight: 500;">
                                    &nbsp<a href="aboutus.html"> About Us</a></span> </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="col-10" style="background-color: #181820; text-align: center;">

                <div id="map" class="container" style="margin-top: 1vw; width: 95%; height: 620px; border-radius: 2vw;">
                </div>


            </div>
        </div>

        <br>

        <div class="row" id="userreports"
            style="width: 100%; background-color: #1D1D27; margin-left: 0.07%; padding: 1vw; border-radius: 2vw; overflow: visible;">
            <h5 style="color: white;">Recent Cases</h5>
            <br>
            <br>

            <!-- <div class="col">
                <div class="card text-white bg-dark mb-3"
                    style="min-width: 18rem; border-style: solid; border-color: #FC76A1; z-index: 1;">
                    <div class="card-header"><i class="fas fa-exclamation-triangle" style="color: #FC76A1;"></i> Case ID
                        #001 <a href="#map" id="fly"
                            style="background-color: #FC76A1; padding: 8px; font-size: 18px; border-radius: 1vw; float: right; margin: 0.5vw;"><i
                                class="fas fa-crosshairs"></i></a></div>
                    <div class="card-body">
                        <h5 class="card-title"><i class="fas fa-skull" style="color: #FC76A1;"></i>
                            Vandalism</h5>
                        <hr>
                        <p class="card-text"><i class="fas fa-user" style="color: #FC76A1;"></i>
                            Kaustubh Utturwar
                            <hr><i class="fas fa-phone" style="color: #FC76A1;"></i> +91 9876543210
                            <hr><i class="fas fa-map-marker-alt" style="color: #FC76A1;"></i> Nerul,
                            Navi Mumbai
                            <hr><i class="fas fa-info-circle" style="color: #FC76A1;"></i> Bunch of
                            people wrecking a cycle store.
                        </p>
                    </div>
                </div>
            </div> -->



        </div>

        <br>


        <!-- Profile Modal -->
        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content" style="background-color: #1D1D26; border-radius: 2vw;">
                    <div class="modal-header"
                        style="background-color: #1D1D26; border-color: #1D1D26; border-radius: 2vw; ">
                        <h5 class="modal-title" id="exampleModalLabel" style="color: white; font-weight: 700;">Your
                            Profile
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" style="background-color: #1D1D26; text-align: center; ">
                        <img src="assets/profilepic.png" style="margin: 0.2vw; height: 200px; width: 200px;">

                        <div style="height: 20px;"></div>
                        <ul class="list-group list-group-flush">
                            <li style="background-color: #1D1D26; color: #FC76A1; font-size: 20px; font-weight: 600;"
                                class="list-group-item">Kaustubh Utturwar</li>
                            <li style="background-color: #1D1D26; color: #FC76A1;" class="list-group-item">Sub Inspector
                            </li>
                            <li style="background-color: #1D1D26; color: #FC76A1;" class="list-group-item">
                                k.utturwar@gmail.com</li>
                            <li style="background-color: #1D1D26; color: #FC76A1;" class="list-group-item">+91
                                7066695395
                            </li>
                        </ul>

                    </div>
                    <div
                        style="background-color: #1D1D26; text-align: center; border-radius: 2vw; margin-bottom: 1.5vw;">
                        <a onclick="logout()" type="button" class="btn-lg hover-item"
                            style="background-color: #30303D; border-color: #fc76a1; font-weight: 500; color: white; border-radius: 1vw;"><i
                                class="fas fa-sign-out-alt"></i> Log Out</a>

                    </div>
                </div>
            </div>
        </div>


        <style>
            .hover-item {
                transition: 0.3s;
            }

            .hover-item:hover {
                transform: translate(0, -5px);
            }

            .fade-item:hover {
                background-color: #272732;
            }

            a {

                text-decoration: none;
                color: white;
            }

            .marker {
                background-image: url('assets/danger.svg');
                border-style: solid;
                border-color: #FC76A1;
                background-color: #FC76A1;
                background-size: cover;
                width: 50px;
                height: 50px;
                border-radius: 50%;
                cursor: pointer;
            }

            .mapboxgl-popup-content {
                font-family: 'Work Sans', sans-serif;
                border-style: solid;
                border-radius: 1vw;
                border-color: #FC76A1;
                color: #FC76A1;
                background-color: #1D1D26;
            }

            .mapboxgl-popup-anchor-top .mapboxgl-popup-tip,
            .mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip,
            .mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip {
                border-bottom-color: #FC76A1;
            }

            .mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip,
            .mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip,
            .mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip {
                border-top-color: #FC76A1
            }

            .mapboxgl-popup-anchor-left .mapboxgl-popup-tip {
                border-right-color: #FC76A1
            }

            .mapboxgl-popup-anchor-right .mapboxgl-popup-tip {
                border-left-color: #FC76A1
            }
        </style>

        <script>
            mapboxgl.accessToken = 'pk.eyJ1Ijoia2F1c3R1YmgwMjA0IiwiYSI6ImNrcjR5c20xMDA1ZDEyd215NGRrcDQxcWwifQ.omZ2nYvuSAL1IHqjrt3eHQ';
            var map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/dark-v10',
                center: [9.0820, 8.6753],
                zoom: 6.5
            });

            // document.getElementById('fly').addEventListener('click', function () {
            //     map.flyTo({
            //         center: [
            //             73.0196, 19.0338
            //         ],
            //         essential: true,
            //         zoom: 15
            //     });
            // });
            // document.getElementById('fly2').addEventListener('click', function () {
            //     map.flyTo({
            //         center: [
            //             73.0404, 19.0237
            //         ],
            //         essential: true,
            //         zoom: 15
            //     });
            // });
            // document.getElementById('fly3').addEventListener('click', function () {
            //     map.flyTo({
            //         center: [
            //             73.0699, 19.0473
            //         ],
            //         essential: true,
            //         zoom: 15
            //     });
            // });
            // document.getElementById('fly4').addEventListener('click', function () {
            //     map.flyTo({
            //         center: [
            //             72.9978, 19.0745
            //         ],
            //         essential: true,
            //         zoom: 15
            //     });
            // });
            // document.getElementById('fly5').addEventListener('click', function () {
            //     map.flyTo({
            //         center: [
            //             73.1175, 18.9894
            //         ],
            //         essential: true,
            //         zoom: 15
            //     });
            // });
            // document.getElementById('fly6').addEventListener('click', function () {
            //     map.flyTo({
            //         center: [
            //             73.0175, 19.0171
            //         ],
            //         essential: true,
            //         zoom: 15
            //     });
            // });
            // document.getElementById('fly7').addEventListener('click', function () {
            //     map.flyTo({
            //         center: [
            //             73.052294, 18.976063
            //         ],
            //         essential: true,
            //         zoom: 15
            //     });
            // });
            // document.getElementById('fly8').addEventListener('click', function () {
            //     map.flyTo({
            //         center: [
            //             73.0140, 19.0601
            //         ],
            //         essential: true,
            //         zoom: 15
            //     });
            // });
            // document.getElementById('fly9').addEventListener('click', function () {
            //     map.flyTo({
            //         center: [
            //             72.9283, 18.8772
            //         ],
            //         essential: true,
            //         zoom: 15
            //     });
            // });

            var geojson = {
                'type': 'FeatureCollection',
                'features': [
                    {
                        'type': 'Feature',
                        'geometry': {
                            'type': 'Point',
                            'coordinates': [73.0196, 19.0338]
                        },
                        'properties': {
                            'title': 'Vandalism',
                            'description': 'Nerul, Navi Mumbai'
                        }
                    },
                    {
                        'type': 'Feature',
                        'geometry': {
                            'type': 'Point',
                            'coordinates': [73.0404, 19.0237]
                        },
                        'properties': {
                            'title': 'Theft',
                            'description': 'Belapur, Navi Mumbai'
                        }
                    },
                    {
                        'type': 'Feature',
                        'geometry': {
                            'type': 'Point',
                            'coordinates': [73.0699, 19.0473]
                        },
                        'properties': {
                            'title': 'Assault',
                            'description': 'Kharghar, Navi Mumbai'
                        }
                    },
                    {
                        'type': 'Feature',
                        'geometry': {
                            'type': 'Point',
                            'coordinates': [72.9978, 19.0745]
                        },
                        'properties': {
                            'title': 'Theft',
                            'description': 'Vashi, Navi Mumbai'
                        }
                    },
                    {
                        'type': 'Feature',
                        'geometry': {
                            'type': 'Point',
                            'coordinates': [73.1175, 18.9894]
                        },
                        'properties': {
                            'title': 'Vandalism',
                            'description': 'Panvel, Navi Mumbai'
                        }
                    },
                    {
                        'type': 'Feature',
                        'geometry': {
                            'type': 'Point',
                            'coordinates': [73.0175, 19.0171]
                        },
                        'properties': {
                            'title': 'Other',
                            'description': 'Seawoods, Navi Mumbai'
                        }
                    },
                    {
                        'type': 'Feature',
                        'geometry': {
                            'type': 'Point',
                            'coordinates': [73.052294, 18.976063]
                        },
                        'properties': {
                            'title': 'Murder',
                            'description': 'Ulwe, Navi Mumbai'
                        }
                    },
                    {
                        'type': 'Feature',
                        'geometry': {
                            'type': 'Point',
                            'coordinates': [73.0140, 19.0601]
                        },
                        'properties': {
                            'title': 'Assault',
                            'description': 'Sanpada, Navi Mumbai'
                        }
                    },
                    {
                        'type': 'Feature',
                        'geometry': {
                            'type': 'Point',
                            'coordinates': [72.9283, 18.8772]
                        },
                        'properties': {
                            'title': 'Other',
                            'description': 'Uran, Navi Mumbai'
                        }
                    }
                ]
            };

            // add markers to map
            geojson.features.forEach(function (marker) {
                // create a HTML element for each feature
                var el = document.createElement('div');
                el.className = 'marker';

                // make a marker for each feature and add it to the map
                new mapboxgl.Marker(el)
                    .setLngLat(marker.geometry.coordinates)
                    .setPopup(
                        new mapboxgl.Popup({ offset: 25 }) // add popups
                            .setHTML(
                                '<h5>' +
                                marker.properties.title +
                                '</h5><hr><h6><i class="fas fa-map-marker"></i> ' +
                                marker.properties.description +
                                '</h6>'
                            )
                    )
                    .addTo(map);
            });

            var size = 200;

            // This implements `StyleImageInterface`
            // to draw a pulsing dot icon on the map.
            var pulsingDot = {
                width: size,
                height: size,
                data: new Uint8Array(size * size * 4),

                // When the layer is added to the map,
                // get the rendering context for the map canvas.
                onAdd: function () {
                    var canvas = document.createElement('canvas');
                    canvas.width = this.width;
                    canvas.height = this.height;
                    this.context = canvas.getContext('2d');
                },

                // Call once before every frame where the icon will be used.
                render: function () {
                    var duration = 1000;
                    var t = (performance.now() % duration) / duration;

                    var radius = (size / 2) * 0.3;
                    var outerRadius = (size / 2) * 0.7 * t + radius;
                    var context = this.context;

                    // Draw the outer circle.
                    context.clearRect(0, 0, this.width, this.height);
                    context.beginPath();
                    context.arc(
                        this.width / 2,
                        this.height / 2,
                        outerRadius,
                        0,
                        Math.PI * 2
                    );
                    context.fillStyle = 'rgba(255, 200, 200,' + (1 - t) + ')';
                    context.fill();

                    // Draw the inner circle.
                    context.beginPath();
                    context.arc(
                        this.width / 2,
                        this.height / 2,
                        radius,
                        0,
                        Math.PI * 2
                    );
                    context.fillStyle = 'rgba(255, 100, 100, 1)';
                    context.strokeStyle = 'white';
                    context.lineWidth = 2 + 4 * (1 - t);
                    context.fill();
                    context.stroke();

                    // Update this image's data with data from the canvas.
                    this.data = context.getImageData(
                        0,
                        0,
                        this.width,
                        this.height
                    ).data;

                    // Continuously repaint the map, resulting
                    // in the smooth animation of the dot.
                    map.triggerRepaint();

                    // Return `true` to let the map know that the image was updated.
                    return true;
                }
            };

            map.on('load', function () {
                map.addImage('pulsing-dot', pulsingDot, { pixelRatio: 2 });

                map.addSource('dot-point', {
                    'type': 'geojson',
                    'data': {
                        'type': 'FeatureCollection',
                        'features': [
                            {
                                'type': 'Feature',
                                'geometry': {
                                    'type': 'Point',
                                    'coordinates': [73.0196, 19.0338] // icon position [lng, lat]
                                }
                            }
                        ]
                    }
                });
                map.addLayer({
                    'id': 'layer-with-pulsing-dot',
                    'type': 'symbol',
                    'source': 'dot-point',
                    'layout': {
                        'icon-image': 'pulsing-dot'
                    }
                });
            });

            //     map.on('load', function () {
            //     map.addSource('earthquakes', {
            //         type: 'geojson',
            //         // Use a URL for the value for the `data` property.
            //         data: 'https://gis-geoserver.ehealthafrica.org/geoserver/eHA_db/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=eHA_db:sv_police_stations&outputFormat=application%2Fjson&authkey=fdfe9a37-d2d0-4210-9a15-25dab5d907fa'
            //     });

            //     map.addLayer({
            //         'id': 'earthquakes-layer',
            //         'type': 'circle',
            //         'source': 'earthquakes',
            //         'paint': {
            //             'circle-radius': 8,
            //             'circle-stroke-width': 2,
            //             'circle-color': 'red',
            //             'circle-stroke-color': 'white',
            //             // 'symbol': 'assets/police-station.png'

            //         }
            //     });
            // });

            map.on('load', function () {
                map.loadImage("https://i.imgur.com/AMhXOvd.png", function (error, image) { //this is where we load the image file 
                    if (error) throw error;
                    map.addImage("custom-marker", image); //this is where we name the image file we are loading 
                    map.addLayer({
                        'id': "markers", //this is the name of the layer, it is what we will reference below 
                        'type': "symbol",
                        'source': { //now we are adding the source to the layer more directly and cleanly 
                            type: "geojson",
                            data: 'https://gis-geoserver.ehealthafrica.org/geoserver/eHA_db/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=eHA_db:sv_police_stations&outputFormat=application%2Fjson&authkey=fdfe9a37-d2d0-4210-9a15-25dab5d907fa' // CHANGE THIS TO REFLECT WHERE YOUR DATA IS COMING FROM
                        },
                        'layout': {
                            "icon-image": "custom-marker", // the name of image file we used above
                            "icon-allow-overlap": false,
                            "icon-size": 1 //this is a multiplier applied to the standard size. So if you want it half the size put ".5"
                        }
                    })
                })

            })

            map.on('click', function (e) {
                var features = map.queryRenderedFeatures(e.point, {
                    layers: ['markers'] // replace this with the name of the layer
                });

                if (!features.length) {
                    return;
                }

                var feature = features[0];

                var popup = new mapboxgl.Popup({ offset: [0, -15] })
                    .setLngLat(feature.geometry.coordinates)
                    .setHTML('<h5>' + feature.properties.name + '</h5><hr><h6>ID: ' + feature.properties.id + '</h6><h6>State code: ' + feature.properties.state_code + '</h6>') // CHANGE THIS TO REFLECT THE PROPERTIES YOU WANT TO SHOW
                    .setLngLat(feature.geometry.coordinates)
                    .addTo(map);
            });

        </script>

        <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase.js"></script>
        <script>
            // Initialize Firebase
            var config = {
                apiKey: "AIzaSyAOghuR0V463DQDrclJBRqMNH7YDqavNmY",
                authDomain: "crime-mapping-7610d.firebaseapp.com",
                projectId: "crime-mapping-7610d",
                storageBucket: "crime-mapping-7610d.appspot.com",
                messagingSenderId: "928787398601",
                appId: "1:928787398601:web:56f96b0e2a1b41aee47218",
                measurementId: "G-KW51ES0TGV"
            };
            firebase.initializeApp(config);
        </script>

        <script src="logout.js"></script>
        <script src="test.js"></script>

</body>

</html>